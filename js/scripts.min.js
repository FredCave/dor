var Controls={cubeButtonsIndex:1,layerNo:1,init:function(){console.log("Controls.init");this.bindEvents(),$("#buttons_wrapper").show()},bindEvents:function(){console.log("Page.bindEvents"),$("#buttons").on("click",".button",function(){$(this).hasClass("off")?($(this).removeClass("off"),Space.showLayer($(this).attr("id"))):($(this).addClass("off"),Space.hideLayer($(this).attr("id")))}),$("#buttons").on("click","label",function(){console.log(60,"Click"),$(this).hasClass("off")?($(this).removeClass("off").siblings(".button").removeClass("off"),Space.showCube($(this).text())):($(this).addClass("off").siblings(".button").addClass("off"),Space.hideCube($(this).text()))}),$("#buttons_toggle").on("click",function(){$(this).hasClass("off")?($(this).text("Hide Controls").removeClass("off"),$("#buttons").show()):($(this).text("Show Controls").addClass("off"),$("#buttons").hide()),Space.toggleAxes()}),$("#buttons").on("mouseover","label",function(a){$("#tooltip").text("Toggle All").css({top:a.clientY+12,left:a.clientX+12,display:"inline-block"})}),$("#buttons").on("mouseover",".button",function(a){var b=$(this).attr("data-name");$("#tooltip").text(b).css({top:a.clientY+12,left:a.clientX+12,display:"inline-block"})}),$("#buttons").on("mouseover",".cube_control",function(a){var b;$(this).hasClass("cube_opacity")?b="Opacity":$(this).hasClass("cube_size")&&(b="Size"),$("#tooltip").text(b).css({top:a.clientY+12,left:a.clientX+12,display:"inline-block"})}),$("#buttons").on("mouseout","div, label",function(a){$("#tooltip").text("").css({top:"",left:"",display:""})})},slidersInit:function(){console.log("Page.slidersInit"),$(".cube_opacity").slider({min:0,max:100,value:100,slide:function(a,b){self.opacitySlide(a,b)},stop:function(a,b){self.opacitySlideStop(a,b)}}),$(".cube_size").slider({min:1,max:100,value:1,slide:function(a,b){self.sizeSlide(a,b)},stop:function(a,b){self.sizeSlideStop(a,b)}})},addCubeButtons:function(){console.log("Page.addCubeButtons");var a=String.fromCharCode(64+this.cubeButtonsIndex);$("#buttons").append("<li data-letter='"+a+"'><label class='off'>"+a+"</label></li>"),this.cubeButtonsIndex++,this.layerNo=1},addLayerButton:function(a){console.log("Page.addLayerButton");var b=$("#buttons li:last-child");b.append("<div class='button off' data-name='"+a+"' id='"+b.data("letter")+this.layerNo+"'>"+this.layerNo+"</div>"),this.layerNo++},addControls:function(){console.log("Page.addControls");var a=$("#buttons li:last-child");a.append("<div class='cube_control cube_opacity'></div>")},opacitySlide:function(a,b){console.log("Page.opacitySlide");var c=b.value;$("#tooltip").text(c).css({top:a.clientY+12,left:a.clientX+12,display:"inline-block"})},sizeSlide:function(a,b){console.log("Page.sizeSlide");var c=b.value+"%";$("#tooltip").text(c).css({top:a.clientY+12,left:a.clientX+12,display:"inline-block"})},opacitySlideStop:function(a,b){console.log("Page.opacitySlideStop");var c=$(a.target).parents("li").attr("data-letter");Space.changeOpacity(c,b.value/100)},sizeSlideStop:function(a,b){console.log("Page.sizeSlideStop");var c=$(a.target).parents("li").attr("data-letter");Space.changeSize(c,b.value/100)}},Page={currentRandomLayers:[],init:function(){console.log("Page.init"),this.loadCubeData()},loadCubeData:function(){console.log("Page.loadCubeData");var a=this;$.get(ROOT+"/wp-json/custom/v1/cubes",function(b){a.cubeData=b,a.cubeDataLoaded()}).fail(function(){console.log("Ajax error. Cube not loaded.")})},cubeDataLoaded:function(){console.log("Page.cubeDataLoaded"),Space.init(),Space.animate(),this.startAudio(),this.startAnimation()},startAudio:function(){console.log("Page.startAudio");var a=this;$("#main_audio").prop("volume",.1),$("#main_audio")[0].play(),$("#main_audio").animate({volume:1},1e3),setTimeout(function(){a.startAudioLoop()},26e4)},startAudioLoop:function(){console.log("Page.startAudioLoop"),$("#loop_audio_1").prop("volume",.1),$("#loop_audio_1")[0].play(),$("#loop_audio_1").animate({volume:1},1e4,function(){var a=2;$("#loop_audio_"+a)[0].play(),setInterval(function(){a=1===a?2:1,$("#loop_audio_"+a)[0].play()},1e4)})},startAnimation:function(){console.log("Page.startAnimation"),this.sceneOne(),_.delay(this.sceneTwo,3e4),_.delay(this.sceneThree,7e4),_.delay(this.sceneFour,105e3),_.delay(this.sceneFive,135e3),_.delay(this.sceneSix,17e4),_.delay(this.sceneSeven,21e4),_.delay(this.sceneEight,251e3)},sceneOne:function(){console.log("Page.sceneOne"),Space.fadeInLayer("A2",2e3),Page.randomFade("A,B,C")},sceneTwo:function(){console.log("Page.sceneTwo"),Space.fadeInLayer("B2",4e3),Space.fadeOutLayer("A2",8e3)},sceneThree:function(){console.log("Page.sceneThree"),Space.fadeInLayer("C2",8e3),Space.fadeOutLayer("B2",8e3)},sceneFour:function(){console.log("Page.sceneFour"),Space.fadeInLayer("D1",8e3),Space.fadeOutLayer("C2",8e3),Page.stopRandomFade(),Page.randomFade("D,E")},sceneFive:function(){console.log("Page.sceneFive"),Space.fadeInLayer("E2",1e4),Space.fadeOutLayer("D1",1e4)},sceneSix:function(){console.log("Page.sceneSix"),Page.stopRandomFade(),Space.fadeOutLayer("E2",5e3);for(var a=1;a<10;a++)Space.fadeInLayer("F"+a,5e3*Math.random()+3e3)},sceneSeven:function(){console.log("Page.sceneSeven"),Space.fadeOutLayer("F8",5e3),_.delay(Space.fadeOutLayer("F1",5e3*Math.random()+3e3),5e3),_.delay(Space.fadeOutLayer("F2",5e3*Math.random()+3e3),1e4),_.delay(Space.fadeOutLayer("F3",5e3*Math.random()+3e3),15e3),_.delay(Space.fadeOutLayer("F5",5e3*Math.random()+3e3),2e4),_.delay(Space.fadeOutLayer("F6",5e3*Math.random()+3e3),25e3),_.delay(Space.fadeOutLayer("F7",5e3*Math.random()+3e3),3e4),_.delay(Space.fadeOutLayer("F9",5e3*Math.random()+3e3),35e3)},sceneEight:function(){console.log("Page.sceneEight"),Space.fadeOutLayer("F4",1e4),Space.fadeInLayer("G1",1e4)},randomFade:function(a){function b(){console.log("Page.randomFade.randomIteration");for(var a=0;a<3;a++){var b=Math.floor(Math.random()*d.length),c=d[b].ID;if(Page.currentRandomLayers.indexOf(c)===-1){var e=1e4*Math.random()+5e3;Space.fadeInLayer(c,e),2===a&&Space.rotateLayer(c),Page.currentRandomLayers.push(c)}else console.log("Already faded in.")}_.delay(function(){for(var a=0;a<Page.currentRandomLayers.length;a++){var b=Page.currentRandomLayers[a];Space.fadeOutLayer(b,5e3*Math.random()+5e3),Page.currentRandomLayers.splice(a,1)}},1e4)}console.log("Page.randomFade");for(var c=a.split(","),d=[],e=["A2","B2","C2","D1","E2"],f=0;f<c.length;f++){var g=c[f].charCodeAt(0)-65;_.each(Page.cubeData[g],function(a){e.indexOf(a.ID)===-1&&d.push(a)})}b(),this.interval=setInterval(function(){b()},2e4)},stopRandomFade:function(){console.log("Page.stopRandomFade"),clearInterval(this.interval),console.log("Interval cleared.");for(var a=0;a<Page.currentRandomLayers.length;a++){var b=Page.currentRandomLayers[a];Space.fadeOutLayer(b,5e3*Math.random()+5e3),Page.currentRandomLayers.splice(a,1)}}};$(document).on("ready",function(){Page.init()});var Space={container:"",scene:"",camera:"",renderer:"",controls:"",cube:"",clock:new THREE.Clock,cubeIndex:0,axesVisible:!1,init:function(){console.log("Space.init");this.scene=new THREE.Scene;var a=window.innerWidth,b=window.innerHeight,c=45,d=a/b,e=.1,f=2e4;this.camera=new THREE.PerspectiveCamera(c,d,e,f),this.scene.add(this.camera),this.camera.position.set(0,-100,400),this.camera.lookAt(this.scene.position),Detector.webgl?this.renderer=new THREE.WebGLRenderer({antialias:!0}):this.renderer=new THREE.CanvasRenderer,this.renderer.setSize(a,b),this.container=document.getElementById("space"),this.container.appendChild(this.renderer.domElement),THREEx.WindowResize(this.renderer,this.camera),this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement);var g=new THREE.AxisHelper(100);g.name="axes",this.scene.add(g),g.visible=!1},animate:function(){var a=this;setTimeout(function(){requestAnimationFrame(function(){a.animate()})},1e3/24),this.render(),this.update(),TWEEN.update()},update:function(){this.controls.update()},render:function(){this.renderer.render(this.scene,this.camera)},generateCube:function(){console.log("Space.generateCube");var a=this,b=Page.cubeData[this.cubeIndex];Controls.addCubeButtons();var c=1;_.each(b,function(b){a.generateLayer(b,c),c++}),Controls.addControls(),this.cubeIndex++,this.cubeIndex<6?this.generateCube():6===this.cubeIndex&&Controls.slidersInit()},generateLayer:function(a){console.log("Space.generateLayer");var b,c,d=5e3,e=!0,f=[];for(var g in a)a.hasOwnProperty(g)&&(a[g]===!1?(e=!1,console.log(135,"Data Incomplete")):"name"===g?b=a[g]:"ID"===g?c=a[g]:f.push(a[g].sizes.extralarge));if(e){for(var h=new THREE.CubeGeometry(d,d,d),i=[],j=0;j<6;j++)i.push(new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture(f[j]),side:THREE.BackSide,transparent:!0,opacity:0}));var k=new THREE.MeshFaceMaterial(i),l=new THREE.Mesh(h,k);l.name=c,this.scene.add(l),l.rotateY(180),Controls.addLayerButton(b)}},hideLayer:function(a){console.log("Space.hideLayer",a);var b=this.scene.getObjectByName(a);_.each(b.material.materials,function(a){a.opacity=0})},showLayer:function(a){console.log("Space.showLayer",a);var b=this.scene.getObjectByName(a);_.each(b.material.materials,function(a){a.opacity=1})},fadeInLayer:function(a,b){console.log("Space.fadeInLayer",a,b);var c=a[0].charCodeAt(0)-65;console.log(225,c);var d=_.findWhere(Page.cubeData[c],{ID:a});console.log(229,Page.cubeData[c]),this.generateLayer(d);for(var e=this.scene.getObjectByName(a),f=0;f<e.material.materials.length;f++)new TWEEN.Tween(e.material.materials[f]).to({opacity:1},b).start()},fadeOutLayer:function(a,b){console.log("Space.fadeOutLayer",a,b);for(var c=this.scene.getObjectByName(a),d=this,e=0;e<c.material.materials.length;e++)new TWEEN.Tween(c.material.materials[e]).to({opacity:0},b).start();_.delay(function(){d.scene.remove(d.scene.getObjectByName(a)),console.log("Layer removed from scene.")},b+1e3)},hideCube:function(a){console.log("Space.hideCube",a);var b=this.scene.children;_.each(b,function(b){b.name.indexOf(a)>-1&&_.each(b.material.materials,function(a){a.opacity=0})})},showCube:function(a){console.log("Space.showCube",a);var b=this.scene.children;_.each(b,function(b){b.name.indexOf(a)>-1&&_.each(b.material.materials,function(a){a.opacity=1})})},toggleAxes:function(){console.log("Space.toggleAxes");var a=this.scene.getObjectByName("axes");this.axesVisible?(a.visible=!1,this.axesVisible=!1):(a.visible=!0,this.axesVisible=!0)},changeOpacity:function(a,b){console.log("Space.changeOpacity",a,b);var c=this.scene.children;_.each(c,function(c){c.name.indexOf(a)>-1&&_.each(c.material.materials,function(a){b>0&&a.opacity>0&&(a.opacity=b)})})},changeSize:function(a,b){console.log("Space.changeSize",a,b);var c=this.scene.children;b=5e3*(b+1),_.each(c,function(c){c.name.indexOf(a)>-1&&(console.log(292,c),c.geometry.depth=b,c.geometry.height=b,c.geometry.width=b)})},rotateLayer:function(a){console.log("Space.rotateLayer",a)},layerPhase:function(a,b){}};